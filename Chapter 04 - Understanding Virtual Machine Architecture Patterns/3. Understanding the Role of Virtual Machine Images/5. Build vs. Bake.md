# 5. Build vs. Bake

Taking a clean installation of the Operating System and using a Configuration Management tool to apply the desired state on it is what I call the "Build" approach. The converse, the "Bake" approach uses an automation tool—like Packer—that will launch a temporary Virtual Machine, set everything up, and then snap a new Virtual Machine Image.

The "Build" Option is ideal for Day 2 Operations because it allows you to easily apply patches and manage the environment over time. With Configuration Management tools in charge, you have a live connection to your Virtual Machines and can update them quickly without disruption. In contrast, when using the Bake approach, you first need to bake a new image, then upgrade all the Virtual Machines to use the latest image. This results in downtime while you tear down the machine using the old image and spin up the machine using the new image. It can also be a slow process to develop the Virtual Machine Image as each bake can take a considerable amount of time—while the Configuration Management tool provides relatively near real-time feedback if there is an issue.

The "Bake" approach truly shines when there is time sensitivity in how fast you need to spin up additional Virtual Machines, and you don't want to wait for the Configuration Manager to do a clean install of your entire solution stack on the Virtual Machine—sucking up valuable time that you could use to service end-user requests. Situations that can benefit from this are:

- Failover & Recovery: When you have identified that a previously healthy Virtual Machine has become unhealthy and needs to be replaced rapidly, this situation could be due to an outage or transient hardware failure.
- Auto-Scaling: When you need to scale up to meet spikes in traffic for your service. When a scale-up event is triggered, it's ideal for your new Virtual Machine to pick up load as quickly as possible. If not, you may have to build additional buffer times by reducing the threshold for scaling up and increasing the threshold for scaling down, thus spinning up earlier and spinning down slower to ensure that the inherent time delay doesn't impact your end users.

Build vs. bake is not a mutually exclusive endeavor. There is usually a split between the two. In most situations, there are usually pieces of configuration that you can never bake into the images. These fall into the following categories:

- Frequency: You should bake configurations that change at a very low frequency into the image. Inversely, you should include configurations you may need to adjust at runtime in the build.
- Post-Provisioning Values: You should bake configurations that require values only available after provisioning. These values might include private IP addresses, DNS host names, or other meta-data generated during provisioning and only known at the end.